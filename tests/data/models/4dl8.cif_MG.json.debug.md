# Metal Coordination Analysis Report: /home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif

## Inputs
- Source: `/home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif`
- Ligand: `MG`
- PDB: `/home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif`
- Class: `None`
- Thresholds: distance=0.5, procrustes=0.3, min_sample_size=30, metal_distance=0.3

## Analysis Steps
### 1. Metal Site Detection
Detected 2 metal coordination site(s) in the model.

```json
{'metal_sites': [{'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}], 'count': 2}
```

### 2. Ligand Environment
Characterized coordinating ligands and compared observed distances with covalent expectations.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'ligands': [{'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 1.999, 'covalent_sum': 1.98, 'covalent_ratio': 1.009, 'is_extra': True}, {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 437, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.176, 'covalent_sum': 2.07, 'covalent_ratio': 1.051, 'is_extra': True}, {'name': 'O2', 'element': 'O', 'chain': 'A', 'residue': 'PO4', 'sequence': 303, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 1.945, 'covalent_sum': 2.07, 'covalent_ratio': 0.94, 'is_extra': True}, {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.068, 'covalent_sum': 2.07, 'covalent_ratio': 0.999, 'is_extra': True}, {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.029, 'covalent_sum': 2.07, 'covalent_ratio': 0.98, 'is_extra': True}, {'name': 'OP2', 'element': 'O', 'chain': 'A', 'residue': 'UMP', 'sequence': 301, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 1.914, 'covalent_sum': 2.07, 'covalent_ratio': 0.925, 'is_extra': True}]}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'ligands': [{'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 1.997, 'covalent_sum': 1.98, 'covalent_ratio': 1.009, 'is_extra': True}, {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 401, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.055, 'covalent_sum': 2.07, 'covalent_ratio': 0.993, 'is_extra': True}, {'name': 'OD2', 'element': 'O', 'chain': 'A', 'residue': 'ASP', 'sequence': 79, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.05, 'covalent_sum': 2.07, 'covalent_ratio': 0.99, 'is_extra': True}, {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.002, 'covalent_sum': 2.07, 'covalent_ratio': 0.967, 'is_extra': True}, {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 2.144, 'covalent_sum': 2.07, 'covalent_ratio': 1.036, 'is_extra': True}, {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 76, 'icode': '.', 'altloc': '', 'symmetry': 0, 'distance': 1.938, 'covalent_sum': 2.07, 'covalent_ratio': 0.936, 'is_extra': True}]}]}
```

### 3. Coordination Number Determination
Determined ligand counts per metal site and tracked base vs extra ligands.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'coordination': {'count': 6, 'ligands': [], 'extra_ligands': ['F3', 'O', 'O2', 'OE2', 'OE2', 'OP2']}}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'coordination': {'count': 6, 'ligands': [], 'extra_ligands': ['F3', 'O', 'OD2', 'OE1', 'OE1', 'OE1']}}]}
```

### 4. Geometry Candidates
Evaluated candidate coordination geometries using Procrustes fit.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'candidates': [{'class': 'octahedral', 'coordination': 6, 'procrustes': 0.07442847639322281}]}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'candidates': [{'class': 'octahedral', 'coordination': 6, 'procrustes': 0.10903780907392502}]}]}
```

### 5. Linear Descriptor Generation
Generated linear descriptors from class code and lexicographic atom ordering.

```json
{'descriptors': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'class': 'octahedral', 'class_code': 'OCT', 'descriptor': '@OCT{Mg,F,O,O,O,O,O}', 'ordered_elements': ['Mg', 'F', 'O', 'O', 'O', 'O', 'O'], 'index_mapping': [0, 1, 3, 2, 4, 5, 6], 'atom_names_with_symmetries': ['MG', 'F3 ', 'O ', 'O2 ', 'OE2 ', 'OE2 ', 'OP2 '], 'element_names': ['Mg', 'F', 'O', 'O', 'O', 'O', 'O'], 'procrustes': 0.07442847639322281, 'rank': 1, 'selected': True}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'class': 'octahedral', 'class_code': 'OCT', 'descriptor': '@OCT{Mg,F,O,O,O,O,O}', 'ordered_elements': ['Mg', 'F', 'O', 'O', 'O', 'O', 'O'], 'index_mapping': [0, 1, 2, 6, 4, 3, 5], 'atom_names_with_symmetries': ['MG', 'F3 ', 'O ', 'OD2 ', 'OE1 ', 'OE1 ', 'OE1 '], 'element_names': ['Mg', 'F', 'O', 'O', 'O', 'O', 'O'], 'procrustes': 0.10903780907392502, 'rank': 1, 'selected': True}]}
```

### 6. Strategy Resolution
Resolved the final statistics path by selecting the first successful strategy per chosen class.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'chosen_strategy': 'WeekCorrespondenceStatsFinder', 'chosen_class': 'octahedral'}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'chosen_strategy': 'WeekCorrespondenceStatsFinder', 'chosen_class': 'octahedral'}]}
```

### 7. Distance Statistics
Computed metal-ligand distance means and uncertainties for the selected geometry.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'distances': []}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'distances': []}]}
```

### 8. Angle Statistics
Computed ligand-ligand angle distributions to evaluate geometric consistency.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'angles': [{'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 437, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 180.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'O2', 'element': 'O', 'chain': 'A', 'residue': 'PO4', 'sequence': 303, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OP2', 'element': 'O', 'chain': 'A', 'residue': 'UMP', 'sequence': 301, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 437, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'O2', 'element': 'O', 'chain': 'A', 'residue': 'PO4', 'sequence': 303, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 437, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 437, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 437, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OP2', 'element': 'O', 'chain': 'A', 'residue': 'UMP', 'sequence': 301, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O2', 'element': 'O', 'chain': 'A', 'residue': 'PO4', 'sequence': 303, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 180.0, 'std': 5.0}, {'ligand1': {'name': 'O2', 'element': 'O', 'chain': 'A', 'residue': 'PO4', 'sequence': 303, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O2', 'element': 'O', 'chain': 'A', 'residue': 'PO4', 'sequence': 303, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OP2', 'element': 'O', 'chain': 'A', 'residue': 'UMP', 'sequence': 301, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OP2', 'element': 'O', 'chain': 'A', 'residue': 'UMP', 'sequence': 301, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OE2', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OP2', 'element': 'O', 'chain': 'A', 'residue': 'UMP', 'sequence': 301, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 180.0, 'std': 5.0}]}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'angles': [{'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 401, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OD2', 'element': 'O', 'chain': 'A', 'residue': 'ASP', 'sequence': 79, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'F3', 'element': 'F', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 76, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 180.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 401, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OD2', 'element': 'O', 'chain': 'A', 'residue': 'ASP', 'sequence': 79, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 401, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 180.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 401, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'O', 'element': 'O', 'chain': 'A', 'residue': 'HOH', 'sequence': 401, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 76, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OD2', 'element': 'O', 'chain': 'A', 'residue': 'ASP', 'sequence': 79, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OD2', 'element': 'O', 'chain': 'A', 'residue': 'ASP', 'sequence': 79, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 180.0, 'std': 5.0}, {'ligand1': {'name': 'OD2', 'element': 'O', 'chain': 'A', 'residue': 'ASP', 'sequence': 79, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 76, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 48, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 76, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}, {'ligand1': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 51, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'ligand2': {'name': 'OE1', 'element': 'O', 'chain': 'A', 'residue': 'GLU', 'sequence': 76, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'angle': 90.0, 'std': 5.0}]}]}
```

### 9. Final Assessment
Summarized selected geometry quality and available metal-metal distance references.

```json
{'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'coordination_number': 6, 'chosen_geometry': 'octahedral', 'procrustes': 0.07442847639322281, 'sample_size': 1015}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'coordination_number': 6, 'chosen_geometry': 'octahedral', 'procrustes': 0.10903780907392502, 'sample_size': 1015}], 'metal_metal': [{'metal1': {'name': 'MG', 'element': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'metal2': {'name': 'NA', 'element': 'Na', 'chain': 'A', 'residue': 'NA', 'sequence': 306, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'distance': 3.4, 'std': 0.2}, {'metal1': {'name': 'MG', 'element': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'metal2': {'name': 'AL', 'element': 'Al', 'chain': 'A', 'residue': 'AF3', 'sequence': 302, 'icode': '.', 'altloc': '', 'symmetry': 0, 'operator': 'x,y,z'}, 'distance': 2.97, 'std': 0.11}]}
```

## Summary
```json
{'coordination_number': None, 'chosen_geometry': None, 'procrustes': None, 'sample_size': None, 'quality_notes': ['Geometry fit within Procrustes threshold.', 'Geometry fit within Procrustes threshold.'], 'sites': [{'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 304, 'icode': '.', 'altloc': ''}, 'coordination_number': 6, 'chosen_geometry': 'octahedral', 'procrustes': 0.07442847639322281, 'sample_size': 1015}, {'metal_site': {'metal': 'MG', 'metalElement': 'Mg', 'chain': 'A', 'residue': 'MG', 'sequence': 305, 'icode': '.', 'altloc': ''}, 'coordination_number': 6, 'chosen_geometry': 'octahedral', 'procrustes': 0.10903780907392502, 'sample_size': 1015}]}
```

## Flags
- none

## Logs
- `2026-02-07T14:16:11Z` `INFO` Found 3 metal-containing ligands.
- `2026-02-07T14:16:11Z` `INFO` Analyzing structures in /home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif for patterns
- `2026-02-07T14:16:11Z` `INFO` Structure for AL - A - AF3 - 302 found. Coordination number: 6. AL F1  F2  F3  O  O1  OP1 
- `2026-02-07T14:16:11Z` `INFO` 1 structures found.
- `2026-02-07T14:16:11Z` `INFO` Candidates for AL - A - AF3 - 302 : ['octahedral']
- `2026-02-07T14:16:12Z` `INFO` Analysis completed. Statistics for 1 ligands(metals) found.
- `2026-02-07T14:16:12Z` `INFO` Report written to /home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif_AF3.json
- `2026-02-07T14:16:12Z` `INFO` Analyzing structures in /home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif for patterns
- `2026-02-07T14:16:12Z` `INFO` Structure for MG - A - MG - 304 found. Coordination number: 6. MG F3  O  O2  OE2  OE2  OP2 
- `2026-02-07T14:16:12Z` `INFO` Structure for MG - A - MG - 305 found. Coordination number: 6. MG F3  O  OD2  OE1  OE1  OE1 
- `2026-02-07T14:16:12Z` `INFO` 2 structures found.
- `2026-02-07T14:16:12Z` `INFO` Candidates for MG - A - MG - 304 : ['octahedral']
- `2026-02-07T14:16:12Z` `INFO` Candidates for MG - A - MG - 305 : ['octahedral']
- `2026-02-07T14:16:23Z` `INFO` Analysis completed. Statistics for 2 ligands(metals) found.
- `2026-02-07T14:16:23Z` `INFO` Report written to /home/lekaveh/projects/MetalCoordAnalysis/tests/data/models/4dl8.cif_MG.json
